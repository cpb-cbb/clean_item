# 语义属性聚类分析工具 (Semantic Property Clustering Tool)

这是一个高级 Python 脚本，旨在对包含频率信息的属性列表（例如，商品名、物理性质等）进行两轮层次化的语义聚类分析。通过结合强大的 `sentence-transformers` 模型和社区发现算法，该工具能够有效地将语义相似的属性分组，并根据其出现频率筛选出核心属性，最终将结构化的结果输出为 CSV 文件。

## 功能特性

- **数据加载与预处理**: 自动从复杂的 JSON 文件中加载属性及其频率数据。
- **两轮聚类策略**:
    1. **初步聚类**: 使用可配置的相似度阈值对所有属性进行快速的初步聚类。
    2. **二次精聚类**: 在每个初步形成的簇内部，应用更严格的阈值进行二次聚类，以提纯和细分属性分组。
- **基于频率的智能合并**: 在二次聚类后，自动将低频次的子簇合并到其组内最高频次的子簇中，有效实现同义词或相似表述的归一化。
- **离群点处理**: 明确识别并单独处理在两轮聚类中都未能成簇的“离群”属性。
- **灵活配置**: 脚本顶部的配置区域允许用户轻松调整文件路径、聚类阈值、最小簇大小和频率筛选标准。
- **结果导出**: 将详细的、层次分明的最终聚类结果保存为 CSV 文件，便于在 Excel、Pandas 或其他数据分析工具中进一步分析。

## 工作流程

1. **加载数据**: 从指定的 JSON 文件中读取属性列表和对应的频率。
2. **生成向量**: 使用 `all-MiniLM-L6-v2` 模型为每个属性生成高维语义向量。
3. **第一轮聚类**: 应用 `util.community_detection` 算法，根据 `PRIMARY_CLUSTER_THRESHOLD` 阈值进行聚类。
4. **第二轮聚类**: 遍历第一轮形成的每个簇，在其内部再次运行社区发现算法，但使用更严格的 `SECONDARY_CLUSTER_THRESHOLD` 阈值。
5. **合并与筛选**: 在每个二次聚类的结果中，将总频率低于 `FREQUENCY_THRESHOLD_PERCENT` 的子簇合并到最高频的子簇中。
6. **处理未聚类项**: 将在第一轮聚类中就“掉队”的属性，以及在第二轮合并后仍然低于频率阈值的独立属性，进行分类处理。
7. **保存结果**: 将所有最终确定的簇（包括合并后的）和高频的未聚类项写入一个结构清晰的 CSV 文件。低频的未聚类项被归入 "Others" 类别。

## 如何使用

请参考 `USAGE.md` 文件获取详细的安装和使用步骤。

## 依赖

- Python 3.8+
- PyTorch
- sentence-transformers
- pandas
- numpy

您可以通过 pip 安装所有必要的库：

```
pip install torch sentence-transformers pandas numpy

```

## 贡献

欢迎通过提交 Pull Requests 或创建 Issues 来为该项目做出贡献。

## 许可证

本项目采用 [MIT 许可证](https://choosealicense.com/licenses/mit/#)。